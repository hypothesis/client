:root {
  // Default highlight styling configuration
  --hypothesis-highlight-color: rgba(255, 255, 60, 0.4);
  --hypothesis-highlight-focused-color: rgba(156, 230, 255, 0.5);
  --hypothesis-highlight-blend-mode: normal;
  --hypothesis-highlight-decoration: none;

  --hypothesis-highlight-second-color: rgba(206, 206, 60, 0.4);
  --hypothesis-highlight-third-color: transparent;
}

// Configure highlight styling.

// Map `--hypothesis-*` root values to local `--highlight-*` values
.hypothesis-svg-highlight {
  --highlight-color: var(--hypothesis-highlight-color);
  --highlight-color-focused: var(--hypothesis-highlight-focused-color);
}

.hypothesis-highlight {
  --highlight-color: var(--hypothesis-highlight-color);
  --highlight-blend-mode: var(--hypothesis-highlight-blend-mode);
  --highlight-decoration: var(--hypothesis-highlight-decoration);
  --highlight-color-focused: var(--hypothesis-highlight-focused-color);

  & .hypothesis-highlight {
    --highlight-color: var(--hypothesis-highlight-second-color);

    .hypothesis-highlight {
      // Highlights more than two levels deep are transparent by default.
      --highlight-color: var(--hypothesis-highlight-third-color);
    }
  }
}

// Apply highlight styling.

// Highlights are non-visible when .hypothesis-highlight-always-on class not present.
.hypothesis-highlight {
  background-color: transparent;
  // For PDFs, we still create highlight elements to wrap the text but the
  // highlight effect is created by another element.
  &.is-transparent {
    background-color: transparent !important;
  }
}

.hypothesis-svg-highlight {
  fill: transparent;
}

// Apply styling using `--highlight-` values when highlights are visible

.hypothesis-highlights-always-on .hypothesis-svg-highlight {
  fill: var(--highlight-color);

  &.is-opaque {
    fill: yellow;
  }

  &.is-focused {
    fill: var(--highlight-color-focused);
  }
}

.hypothesis-highlights-always-on .hypothesis-highlight {
  background-color: var(--highlight-color);
  text-decoration: var(--highlight-decoration);
  mix-blend-mode: var(--highlight-blend-mode);

  cursor: pointer;

  // Make highlights visible to screen readers.
  // See also - https://developer.paciellogroup.com/blog/2017/12/short-note-on-making-your-mark-more-accessible/.
  &::before {
    @apply sr-only;

    // nb. The leading/trailing spaces are intended to ensure the text is treated
    // as separate words by assistive technologies from the content before/after it.
    content: ' annotation start ';
  }
  &::after {
    @apply sr-only;
    content: ' annotation end ';
  }
}

// Apply focused-highlight styling

.hypothesis-highlights-always-on
  .hypothesis-highlight.hypothesis-highlight-focused {
  // When an annotation card is hovered in the sidebar, the corresponding
  // highlights are shown with a "focused" color.
  &.hypothesis-highlight-focused {
    mix-blend-mode: normal !important;
    background-color: var(--highlight-color-focused) !important;
    text-decoration: none;

    .hypothesis-highlight {
      background-color: transparent !important;
    }
  }
}

// Placeholder element to which annotations for off-screen content in PDFs
// is anchored.
.annotator-placeholder {
  opacity: 0;
  position: absolute;
  top: 50%;
  z-index: -1;
}
